name: Cool Metrics Display
on:
  # 每天午夜运行
  schedule: [{cron: "0 0 * * *"}]
  # 允许手动触发
  workflow_dispatch:
  push: {branches: ["master", "main"]}

jobs:
  github-metrics:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      # ---------------------------------------------------------
      # 图表 1: 核心概览 + 3D 贡献日历 (最显眼的主图)
      # ---------------------------------------------------------
      - name: 1. General & IsoCalendar
        uses: lowlighter/metrics@latest
        with:
          filename: metrics.isocalendar.svg
          token: ${{ secrets.METRICS_TOKEN }}
          base: header, repositories
          # 3D 贡献日历插件
          plugin_isocalendar: yes
          plugin_isocalendar_duration: half-year

      # ---------------------------------------------------------
      # 图表 2: 编程习惯 + 语言雷达图 (分析你的编码风格)
      # ---------------------------------------------------------
      - name: 2. Habits & Languages
        uses: lowlighter/metrics@latest
        with:
          filename: metrics.habits.svg
          token: ${{ secrets.METRICS_TOKEN }}
          base: "" # 不显示头像等基础信息，纯数据
          config_timezone: Asia/Shanghai
          
          # 编程习惯 (分析你是在白天还是晚上写代码)
          plugin_habits: yes
          plugin_habits_from: 200 # 分析最近200个commit
          plugin_habits_days: 14  # 分析最近14天
          plugin_habits_facts: yes
          plugin_habits_charts: yes
          
          # 详细的语言分析
          plugin_languages: yes
          plugin_languages_indepth: yes
          plugin_languages_sections: most-used
          plugin_languages_details: lines, bytes-size, percentage

      # ---------------------------------------------------------
      # 图表 3: 成就墙 + 技能图标 (展示你的辉煌战绩)
      # ---------------------------------------------------------
      - name: 3. Achievements & Topics
        uses: lowlighter/metrics@latest
        with:
          filename: metrics.achievements.svg
          token: ${{ secrets.METRICS_TOKEN }}
          base: ""
          
          # GitHub 成就 (解锁了哪些勋章)
          plugin_achievements: yes
          plugin_achievements_display: compact
          plugin_achievements_threshold: X # 显示所有成就
          
          # 你 Star 的话题/技术栈图标
          plugin_topics: yes
          plugin_topics_limit: 12
          plugin_topics_mode: icons
